import{u as k,b5 as D,a as c,d as L,e as T,w as C,ba as y,c as m}from"./index.536c7d72.js";import{u as R}from"./index.990798b2.js";import{l as u}from"./lodash.bce5b897.js";import{a as M,b as P}from"./index.607eab70.js";import{f as l}from"./index.9c0cbe29.js";import g from"./state-card.b5b52f5c.js";import x from"./definition-card.296b98f2.js";import{g as H}from"./DatePicker.9d2907ba.js";import{s as w}from"./index.32451d2c.js";import{N as S,a as h}from"./Grid.f7dd02c2.js";import"./service.4ca56d82.js";import"./Pie.eab71161.js";import"./index.d67ddc9d.js";import"./index.67b00418.js";import"./Card.1fac8dc8.js";import"./use-rtl.b3456902.js";import"./resolve-slot.12a336d2.js";import"./index.7a579f81.js";import"./keysOf.10525521.js";import"./DataTable.4d10e01f.js";import"./ArrowDown.e4a7e0d5.js";import"./format-length.a0cbed4d.js";import"./Button.9dd5ee3c.js";import"./is-browser.f4bc45cf.js";import"./Scrollbar.7c2bcabe.js";import"./fade-in.cssr.ef9eaee7.js";import"./VResizeObserver.0aad584a.js";import"./Checkbox.9b98fe51.js";import"./RadioGroup.5a44255f.js";import"./flatten.f4456e1c.js";import"./get-slot.7f666ba0.js";import"./Radio.8f1c774c.js";import"./Popover.374e8a7f.js";import"./index.8209174c.js";import"./utils.ba7f47bf.js";import"./use-compitable.7f10f89e.js";import"./next-frame-once.e5ee25e8.js";import"./Suffix.4fa63b0d.js";import"./Dropdown.8c20a4f5.js";import"./Icon.36d6d904.js";import"./ChevronRight.ffdb37b1.js";import"./Selection.2ed26059.js";import"./use-locale.31127f4e.js";import"./fade-in-scale-up.cssr.1167eea7.js";import"./use-keyboard.3c40c702.js";import"./Ellipsis.b0d6a040.js";import"./Tooltip.2dc588a0.js";import"./Input.4b8b409e.js";import"./Select.eddb521d.js";import"./Forward.5223a2c3.js";import"./Bar.dac6af15.js";function V(){const{t:s}=k(),e=D({taskLoadingRef:c(!1)});return{getTaskState:t=>{if(e.taskLoadingRef)return;e.taskLoadingRef=!0;const{state:n}=R(M({startDate:t?l(t[0],"yyyy-MM-dd HH:mm:ss"):"",endDate:t?l(t[1],"yyyy-MM-dd HH:mm:ss"):"",projectCode:0}).then(i=>{const r=i.taskCountDtos.map((a,f)=>({state:s("home."+u.exports.toLower(a.taskStateType)),number:a.count})),o=i.taskCountDtos.map(a=>({value:a.count,name:s("home."+u.exports.toLower(a.taskStateType))}));return e.taskLoadingRef=!1,{table:r,chart:o}}),{table:[],chart:[]});return n},taskVariables:e}}function _(){const{t:s}=k(),e=D({processLoadingRef:c(!1)});return{getProcessState:t=>{if(e.processLoadingRef)return;e.processLoadingRef=!0;const{state:n}=R(P({startDate:t?l(t[0],"yyyy-MM-dd HH:mm:ss"):"",endDate:t?l(t[1],"yyyy-MM-dd HH:mm:ss"):"",projectCode:0}).then(i=>{const r=i.taskCountDtos.map(a=>({state:s("home."+u.exports.toLower(a.taskStateType)),number:a.count})),o=i.taskCountDtos.map(a=>({value:a.count,name:s("home."+u.exports.toLower(a.taskStateType))}));return e.processLoadingRef=!1,{table:r,chart:o}}),{table:[],chart:[]});return n},processVariables:e}}const wt=L({name:"home",setup(){const{t:s,locale:e}=k(),p=c([H(w()),Date.now()]),t=c(),n=c(),{getTaskState:i,taskVariables:r}=V(),{getProcessState:o,processVariables:a}=_(),f=()=>{t.value=i(p.value)||t.value,n.value=o(p.value)||n.value},b=d=>{t.value=i(d)},v=d=>{n.value=o(d)};return T(()=>{f()}),C(()=>e.value,()=>f()),{t:s,dateRef:p,handleTaskDate:b,handleProcessDate:v,taskStateRef:t,processStateRef:n,...y(r),...y(a)}},render(){const{t:s,dateRef:e,handleTaskDate:p,handleProcessDate:t,taskLoadingRef:n,processLoadingRef:i}=this;return m("div",null,[m(S,{"x-gap":12,cols:2},{default:()=>[m(h,null,{default:()=>{var r,o;return[m(g,{title:s("home.task_state_statistics"),date:e,tableData:(r=this.taskStateRef)==null?void 0:r.value.table,chartData:(o=this.taskStateRef)==null?void 0:o.value.chart,onUpdateDatePickerValue:p,loadingRef:n},null)]}}),m(h,null,{default:()=>{var r,o;return[m(g,{title:s("home.process_state_statistics"),date:e,tableData:(r=this.processStateRef)==null?void 0:r.value.table,chartData:(o=this.processStateRef)==null?void 0:o.value.chart,onUpdateDatePickerValue:t,loadingRef:i},null)]}})]}),m(S,{cols:1,style:"margin-top: 12px;"},{default:()=>[m(h,null,{default:()=>[m(x,{title:s("home.process_definition_statistics")},null)]})]})])}});export{wt as default};
