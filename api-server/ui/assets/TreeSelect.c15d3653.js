import{d as me,t as v,bx as Hn,ap as qn,bM as Cn,ao as Wn,ar as Xn,y as Nn,A as Ee,X as Yn,Y as Gn,N as Qn,a as D,v as sn,n as T,e as Zn,Z as le,a0 as Jn,ab as et,g as P,f as de,i as $,bN as bn,h as ye,Q as _e,a1 as cn,m as Tn,l as Ye,R as Ue,z as A,w as We,B as Dn,s as Fn,J as kn,K as nt,T as tt,G as lt}from"./index.536c7d72.js";import{a as at}from"./Checkbox.9b98fe51.js";import{h as un,V as ot,N as Pn,c as An,f as xn,a as rt,u as it,b as dt,F as st}from"./Selection.2ed26059.js";import{i as ct}from"./is-browser.f4bc45cf.js";import{p as ut,g as ft}from"./index.7a579f81.js";import{u as we,X as pn}from"./Scrollbar.7c2bcabe.js";import{a as Ln,c as B,r as ht}from"./resolve-slot.12a336d2.js";import{f as gt,m as vt}from"./fade-in-scale-up.cssr.1167eea7.js";import{u as yt}from"./use-locale.31127f4e.js";import{u as mt}from"./Button.9dd5ee3c.js";import{c as bt}from"./index.8209174c.js";import{u as fn,V as kt,d as xt,e as pt}from"./Popover.374e8a7f.js";function En(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const wt=me({name:"Switcher",render(){return v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},v("path",{d:"M12 8l10 8l-10 8z"}))}}),St=e=>{const{popoverColor:t,boxShadow2:o,borderRadius:u,heightMedium:r,dividerColor:f,textColor2:k}=e;return{menuPadding:"4px",menuColor:t,menuBoxShadow:o,menuBorderRadius:u,menuHeight:`calc(${r} * 7.6)`,actionDividerColor:f,actionTextColor:k,actionPadding:"8px 12px"}},Rt=Hn({name:"TreeSelect",common:qn,peers:{Tree:Cn,Empty:Wn,InternalSelection:Xn},self:St}),Kt=Rt,hn=Nn("n-tree-select"),Me=Nn("n-tree"),Ct=me({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},expanded:Boolean,hide:Boolean,loading:Boolean,onClick:Function},setup(e){const{renderSwitcherIconRef:t}=Ee(Me,null);return()=>{const{clsPrefix:o}=e;return v("span",{"data-switcher":!0,class:[`${o}-tree-node-switcher`,{[`${o}-tree-node-switcher--expanded`]:e.expanded,[`${o}-tree-node-switcher--hide`]:e.hide}],onClick:e.onClick},v("div",{class:`${o}-tree-node-switcher__icon`},v(Yn,null,{default:()=>{if(e.loading)return v(Gn,{clsPrefix:o,key:"loading",radius:85,strokeWidth:20});const{value:u}=t;return u?u():v(Qn,{clsPrefix:o,key:"switcher"},{default:()=>v(wt,null)})}})))}}}),Nt=me({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Ee(Me);function o(r){const{onCheck:f}=e;if(f)return f(r)}function u(r){e.indeterminate?o(!1):o(r)}return{handleUpdateValue:u,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:o,indeterminate:u,disabled:r,focusable:f,handleUpdateValue:k}=this;return v("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],"data-checkbox":!0},v(at,{focusable:f,disabled:r,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:o,indeterminate:u,onUpdateChecked:k}))}}),Tt=me({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:o,renderSuffixRef:u,labelFieldRef:r}=Ee(Me),f=D(null);function k(K){const{onClick:g}=e;g&&g(K)}function m(K){k(K)}return{selfRef:f,renderLabel:t,renderPrefix:o,renderSuffix:u,labelField:r,handleClick:m}},render(){const{clsPrefix:e,labelField:t,nodeProps:o,checked:u=!1,selected:r=!1,renderLabel:f,renderPrefix:k,renderSuffix:m,handleClick:K,onDragstart:g,tmNode:{rawNode:b,rawNode:{prefix:y,suffix:h,[t]:S}}}=this;return v("span",Object.assign({},o,{ref:"selfRef",class:[`${e}-tree-node-content`,o==null?void 0:o.class],onClick:K,draggable:g===void 0?void 0:!0,onDragstart:g}),k||y?v("div",{class:`${e}-tree-node-content__prefix`},k?k({option:b,selected:r,checked:u}):sn(y)):null,v("div",{class:`${e}-tree-node-content__text`},f?f({option:b,selected:r,checked:u}):sn(S)),m||h?v("div",{class:`${e}-tree-node-content__suffix`},m?m({option:b,selected:r,checked:u}):sn(h)):null)}});function wn({position:e,offsetLevel:t,indent:o,el:u}){const r={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")r.left=0,r.top=0,r.bottom=0,r.borderRadius="inherit",r.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const f=e==="before"?"top":"bottom";r[f]=0,r.left=`${u.offsetLeft+6-t*o}px`,r.height="2px",r.backgroundColor="var(--n-drop-mark-color)",r.transformOrigin=f,r.borderRadius="1px",r.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return v("div",{style:r})}function Dt({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}const Ft=me({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Ee(Me),{droppingNodeParentRef:o,droppingMouseNodeRef:u,draggingNodeRef:r,droppingPositionRef:f,droppingOffsetLevelRef:k,nodePropsRef:m,indentRef:K,blockLineRef:g,checkboxPlacementRef:b}=t,y=T(()=>t.disabledRef.value||e.tmNode.disabled),h=T(()=>{const{value:d}=m;if(!!d)return d({option:e.tmNode.rawNode})}),S=D(null),R={value:null};Zn(()=>{R.value=S.value.$el});function _(){const{tmNode:d}=e;if(!d.isLeaf&&!d.shallowLoaded){if(!t.loadingKeysRef.value.has(d.key))t.loadingKeysRef.value.add(d.key);else return;const{onLoadRef:{value:N}}=t;N&&N(d.rawNode).then(()=>{t.handleSwitcherClick(d)}).finally(()=>{t.loadingKeysRef.value.delete(d.key)})}else t.handleSwitcherClick(d)}const U=le(()=>!e.tmNode.disabled&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0));function C(d){const{value:N}=t.expandOnClickRef,{value:L}=U;if(!L&&!N||un(d,"checkbox")||un(d,"switcher"))return;const{tmNode:ce}=e;L&&t.handleSelect(ce),N&&!ce.isLeaf&&_()}function E(d){var N,L;g.value||(y.value||C(d),(L=(N=h.value)===null||N===void 0?void 0:N.onClick)===null||L===void 0||L.call(N,d))}function O(d){var N,L;!g.value||(y.value||C(d),(L=(N=h.value)===null||N===void 0?void 0:N.onClick)===null||L===void 0||L.call(N,d))}function j(d){t.handleCheck(e.tmNode,d)}function V(d){t.handleDragStart({event:d,node:e.tmNode})}function ae(d){d.currentTarget===d.target&&t.handleDragEnter({event:d,node:e.tmNode})}function se(d){d.preventDefault(),t.handleDragOver({event:d,node:e.tmNode})}function Q(d){t.handleDragEnd({event:d,node:e.tmNode})}function oe(d){d.currentTarget===d.target&&t.handleDragLeave({event:d,node:e.tmNode})}function Se(d){d.preventDefault(),f.value!==null&&t.handleDrop({event:d,node:e.tmNode,dropPosition:f.value})}return{showDropMark:le(()=>{const{value:d}=r;if(!d)return;const{value:N}=f;if(!N)return;const{value:L}=u;if(!L)return;const{tmNode:ce}=e;return ce.key===L.key}),showDropMarkAsParent:le(()=>{const{value:d}=o;if(!d)return!1;const{tmNode:N}=e,{value:L}=f;return L==="before"||L==="after"?d.key===N.key:!1}),pending:le(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:le(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:le(()=>{var d;return(d=t.highlightKeySetRef.value)===null||d===void 0?void 0:d.has(e.tmNode.key)}),checked:le(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),indeterminate:le(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:le(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:le(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:y,checkable:T(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),checkboxDisabled:T(()=>!!e.tmNode.rawNode.checkboxDisabled),selectable:U,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:g,nodeProps:h,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:f,droppingOffsetLevel:k,indent:K,checkboxPlacement:b,contentInstRef:S,contentElRef:R,handleCheck:j,handleDrop:Se,handleDragStart:V,handleDragEnter:ae,handleDragOver:se,handleDragEnd:Q,handleDragLeave:oe,handleLineClick:O,handleContentClick:E,handleSwitcherClick:_}},render(){const{tmNode:e,clsPrefix:t,checkable:o,expandOnClick:u,selectable:r,selected:f,checked:k,highlight:m,draggable:K,blockLine:g,indent:b,disabled:y,pending:h,internalScrollable:S,nodeProps:R,checkboxPlacement:_}=this,U=K&&!y?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,C=S?En(e.key):void 0,E=_==="right",O=o?v(Nt,{right:E,focusable:this.checkboxFocusable,disabled:y||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return v("div",Object.assign({class:`${t}-tree-node-wrapper`},U),v("div",Object.assign({},g?R:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:f,[`${t}-tree-node--checkable`]:o,[`${t}-tree-node--highlight`]:m,[`${t}-tree-node--pending`]:h,[`${t}-tree-node--disabled`]:y,[`${t}-tree-node--selectable`]:r,[`${t}-tree-node--clickable`]:r||u},R==null?void 0:R.class],"data-key":C,draggable:K&&g,onClick:this.handleLineClick,onDragstart:K&&g&&!y?this.handleDragStart:void 0}),Jn(e.level,v("div",{class:`${t}-tree-node-indent`},v("div",{style:{width:`${b}px`}}))),v(Ct,{clsPrefix:t,expanded:this.expanded,loading:this.loading,hide:e.isLeaf,onClick:this.handleSwitcherClick}),E?null:O,v(Tt,{ref:"contentInstRef",clsPrefix:t,checked:k,selected:f,onClick:this.handleContentClick,nodeProps:g?void 0:R,onDragstart:K&&!g&&!y?this.handleDragStart:void 0,tmNode:e}),K?this.showDropMark?wn({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:b}):this.showDropMarkAsParent?wn({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:b}):null:null,E?O:null))}}),On=Ft;function In(e,t,o,u){e==null||e.forEach(r=>{o(r),In(r[t],t,o,u),u(r)})}function Pt(e,t,o,u,r){const f=new Set,k=new Set,m=[];return In(e,u,K=>{if(m.push(K),r(t,K)){k.add(K[o]);for(let g=m.length-2;g>=0;--g)if(!f.has(m[g][o]))f.add(m[g][o]);else return}},()=>{m.pop()}),{expandedKeys:Array.from(f),highlightKeySet:k}}const Sn=null;if(ct&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function At(e,t,o,u,r){const f=new Set,k=new Set,m=new Set,K=[],g=[],b=[];function y(S){S.forEach(R=>{if(b.push(R),t(o,R)){f.add(R[u]),m.add(R[u]);for(let U=b.length-2;U>=0;--U){const C=b[U][u];if(!k.has(C))k.add(C),f.has(C)&&f.delete(C);else break}}const _=R[r];_&&y(_),b.pop()})}y(e);function h(S,R){S.forEach(_=>{const U=_[u],C=f.has(U),E=k.has(U);if(!C&&!E)return;const O=_[r];if(O)if(C)R.push(_);else{K.push(U);const j=Object.assign(Object.assign({},_),{[r]:[]});R.push(j),h(O,j[r])}else R.push(_)})}return h(e,g),{filteredTree:g,highlightKeySet:m,expandedKeys:K}}function Lt({fNodesRef:e,mergedExpandedKeysRef:t,mergedSelectedKeysRef:o,handleSelect:u,handleSwitcherClick:r}){const{value:f}=o,k=Ee(hn,null),m=k?k.pendingNodeKeyRef:D(f.length?f[f.length-1]:null);function K(g){const{value:b}=m;if(b===null){if((g.key==="ArrowDown"||g.key==="ArrowUp")&&g.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(g.key)&&b===null){const{value:y}=e;let h=0;for(;h<y.length;){if(!y[h].disabled){m.value=y[h].key;break}h+=1}}}else{const{value:y}=e;let h=y.findIndex(S=>S.key===b);if(!~h)return;if(g.key==="Enter")u(y[h]);else if(g.key==="ArrowDown")for(g.preventDefault(),h+=1;h<y.length;){if(!y[h].disabled){m.value=y[h].key;break}h+=1}else if(g.key==="ArrowUp")for(g.preventDefault(),h-=1;h>=0;){if(!y[h].disabled){m.value=y[h].key;break}h-=1}else if(g.key==="ArrowLeft"){const S=y[h];if(S.isLeaf||!t.value.includes(b)){const R=S.getParent();R&&(m.value=R.key)}else r(S)}else if(g.key==="ArrowRight"){const S=y[h];if(S.isLeaf)return;if(!t.value.includes(b))r(S);else for(h+=1;h<y.length;){if(!y[h].disabled){m.value=y[h].key;break}h+=1}}}}return{pendingNodeKeyRef:m,handleKeydown:K}}const Et=me({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return v(et,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>v("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:ut(this.height)}},this.nodes.map(t=>v(On,{clsPrefix:e,tmNode:t})))})}}),Ot=P("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[de("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),de(">",[P("tree-node",[de("&:first-child",{marginTop:0})])]),P("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 height: 0;
 `),P("tree-motion-wrapper",[$("expand",[bn({duration:"0.2s"})]),$("collapse",[bn({duration:"0.2s",reverse:!0})])]),P("tree-node-wrapper",`
 box-sizing: border-box;
 padding: 3px 0;
 `),P("tree-node",`
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[$("highlight",[P("tree-node-content",[ye("text",{borderBottomColor:"var(--n-node-text-color-disabled)"})])]),$("disabled",[P("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),_e("disabled",[$("clickable",[P("tree-node-content",`
 cursor: pointer;
 `)])])]),$("block-node",[P("tree-node-content",`
 flex-grow: 1;
 flex-shrink: 0;
 `)]),_e("block-line",[P("tree-node",[_e("disabled",[P("tree-node-content",[de("&:hover",{backgroundColor:"var(--n-node-color-hover)"})]),$("selectable",[P("tree-node-content",[de("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),$("pending",[P("tree-node-content",`
 background-color: var(--n-node-color-hover);
 `)]),$("selected",[P("tree-node-content",{backgroundColor:"var(--n-node-color-active)"})])])])]),$("block-line",[P("tree-node",[_e("disabled",[de("&:hover",{backgroundColor:"var(--n-node-color-hover)"}),$("pending",`
 background-color: var(--n-node-color-hover);
 `),$("selectable",[_e("selected",[de("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),$("selected",{backgroundColor:"var(--n-node-color-active)"})]),$("disabled",`
 cursor: not-allowed;
 `)])]),P("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: 24px;
 width: 24px;
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[ye("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[P("icon",[cn()]),P("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[cn()]),P("base-icon",[cn()])]),$("hide",{visibility:"hidden"}),$("expanded",{transform:"rotate(90deg)"})]),P("tree-node-checkbox",`
 display: inline-flex;
 height: 24px;
 width: 16px;
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 margin-right: 4px;
 `,[$("right","margin-left: 4px;")]),$("checkable",[P("tree-node-content",`
 padding: 0 6px;
 `)]),P("tree-node-content",`
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: 24px;
 box-sizing: border-box;
 line-height: 1.5;
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 text-decoration-color: #0000;
 text-decoration-line: underline;
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[de("&:last-child",{marginBottom:0}),ye("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),ye("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow:1;
 `),ye("suffix",`
 display: inline-flex;
 `)]),ye("empty","margin: auto;")]);var It=globalThis&&globalThis.__awaiter||function(e,t,o,u){function r(f){return f instanceof o?f:new o(function(k){k(f)})}return new(o||(o=Promise))(function(f,k){function m(b){try{g(u.next(b))}catch(y){k(y)}}function K(b){try{g(u.throw(b))}catch(y){k(y)}}function g(b){b.done?f(b.value):r(b.value).then(m,K)}g((u=u.apply(e,t||[])).next())})};const Xe=30;function Bn(e,t){return{getKey(o){return o[e]},getChildren(o){return o[t]},getDisabled(o){return!!(o.disabled||o.checkboxDisabled)}}}const _n={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},Bt=Object.assign(Object.assign(Object.assign(Object.assign({},Ye.props),{showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},indent:{type:Number,default:16},allowDrop:{type:Function,default:Dt},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),_n),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),_t=me({name:"Tree",props:Bt,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:o}=Tn(e),u=Ye("Tree","-tree",Ot,Cn,e,t),r=D(null),f=D(null),k=D(null);function m(){var n;return(n=k.value)===null||n===void 0?void 0:n.listElRef}function K(){var n;return(n=k.value)===null||n===void 0?void 0:n.itemsElRef}const g=T(()=>{const{pattern:n}=e;return n?!n.length||!Ne.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:At(e.data,Ne.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),b=T(()=>An(e.showIrrelevantNodes?e.data:g.value.filteredTree,Bn(e.keyField,e.childrenField))),y=Ee(hn,null),h=e.internalTreeSelect?y.dataTreeMate:b,{watchProps:S}=e,R=D([]);S!=null&&S.includes("defaultCheckedKeys")?Ue(()=>{R.value=e.defaultCheckedKeys}):R.value=e.defaultCheckedKeys;const _=A(e,"checkedKeys"),U=we(_,R),C=T(()=>h.value.getCheckedKeys(U.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),E=T(()=>e.leafOnly?"child":e.checkStrategy),O=T(()=>C.value.checkedKeys),j=T(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:C.value.indeterminateKeys}),V=D([]);S!=null&&S.includes("defaultSelectedKeys")?Ue(()=>{V.value=e.defaultSelectedKeys}):V.value=e.defaultSelectedKeys;const ae=A(e,"selectedKeys"),se=we(ae,V),Q=D([]),oe=n=>{Q.value=e.defaultExpandAll?h.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};S!=null&&S.includes("defaultExpandedKeys")?Ue(()=>oe(void 0)):Ue(()=>oe(e.defaultExpandedKeys));const Se=A(e,"expandedKeys"),d=we(Se,Q),N=T(()=>b.value.getFlattenedNodes(d.value)),{pendingNodeKeyRef:L,handleKeydown:ce}=Lt({mergedSelectedKeysRef:se,fNodesRef:N,mergedExpandedKeysRef:d,handleSelect:x,handleSwitcherClick:s});let W=null,ue=null;const Oe=D(new Set),$e=T(()=>e.internalHighlightKeySet||g.value.highlightKeySet),Ge=we($e,Oe),Re=D(new Set),Qe=T(()=>d.value.filter(n=>!Re.value.has(n)));let be=0;const fe=D(null),ke=D(null),Z=D(null),Ke=D(null),Ce=D(0),ze=T(()=>{const{value:n}=ke;return n?n.parent:null}),Ne=T(()=>{const{filter:n}=e;if(n)return n;const{labelField:a}=e;return(i,c)=>{if(!i.length)return!0;const p=c[a];return typeof p=="string"?p.toLowerCase().includes(i.toLowerCase()):!1}});We(A(e,"data"),()=>{Re.value.clear(),L.value=null,xe()},{deep:!1});let X;We(A(e,"pattern"),(n,a)=>{if(e.showIrrelevantNodes)if(X=void 0,n){const{expandedKeys:i,highlightKeySet:c}=Pt(e.data,e.pattern,e.keyField,e.childrenField,Ne.value);Oe.value=c,ge(i,G(i))}else Oe.value=new Set;else if(!n.length)X!==void 0&&ge(X,G(X));else{a.length||(X=d.value);const{expandedKeys:i}=g.value;i!==void 0&&ge(i,G(i))}});function Te(n){return It(this,void 0,void 0,function*(){const{onLoad:a}=e;if(!a)return yield Promise.resolve();const{value:i}=Re;return yield new Promise(c=>{i.has(n.key)||(i.add(n.key),a(n.rawNode).then(()=>{i.delete(n.key),c()}).catch(p=>{console.error(p),ve()}))})})}Ue(()=>{var n;const{value:a}=b;if(!a)return;const{getNode:i}=a;(n=d.value)===null||n===void 0||n.forEach(c=>{const p=i(c);p&&!p.shallowLoaded&&Te(p)})});const he=D(!1),J=D([]);We(Qe,(n,a)=>{if(!e.animated){kn(Fe);return}const i=new Set(a);let c=null,p=null;for(const z of n)if(!i.has(z)){if(c!==null)return;c=z}const ne=new Set(n);for(const z of a)if(!ne.has(z)){if(p!==null)return;p=z}if(c!==null&&p!==null||c===null&&p===null)return;const{virtualScroll:H}=e,Be=(H?k.value.listElRef:r.value).offsetHeight,pe=Math.ceil(Be/Xe)+1;if(c!==null){he.value=!0,J.value=b.value.getFlattenedNodes(a);const z=J.value.findIndex(q=>q.key===c);if(~z){const q=xn(J.value[z].children,n);J.value.splice(z+1,0,{__motion:!0,mode:"expand",height:H?q.length*Xe:void 0,nodes:H?q.slice(0,pe):q})}}if(p!==null){J.value=b.value.getFlattenedNodes(n);const z=J.value.findIndex(q=>q.key===p);if(~z){const q=J.value[z].children;if(!q)return;he.value=!0;const te=xn(q,n);J.value.splice(z+1,0,{__motion:!0,mode:"collapse",height:H?te.length*Xe:void 0,nodes:H?te.slice(0,pe):te})}}});const Ze=T(()=>rt(N.value)),De=T(()=>he.value?J.value:N.value);function Fe(){const{value:n}=f;n&&n.sync()}function Je(){he.value=!1,e.virtualScroll&&kn(Fe)}function G(n){const{getNode:a}=h.value;return n.map(i=>{var c;return((c=a(i))===null||c===void 0?void 0:c.rawNode)||null})}function ge(n,a){const{"onUpdate:expandedKeys":i,onUpdateExpandedKeys:c}=e;Q.value=n,i&&B(i,n,a),c&&B(c,n,a)}function je(n,a){const{"onUpdate:checkedKeys":i,onUpdateCheckedKeys:c}=e;R.value=n,c&&B(c,n,a),i&&B(i,n,a)}function en(n,a){const{"onUpdate:indeterminateKeys":i,onUpdateIndeterminateKeys:c}=e;i&&B(i,n,a),c&&B(c,n,a)}function Ie(n,a){const{"onUpdate:selectedKeys":i,onUpdateSelectedKeys:c}=e;V.value=n,c&&B(c,n,a),i&&B(i,n,a)}function nn(n){const{onDragenter:a}=e;a&&B(a,n)}function tn(n){const{onDragleave:a}=e;a&&B(a,n)}function Ve(n){const{onDragend:a}=e;a&&B(a,n)}function ln(n){const{onDragstart:a}=e;a&&B(a,n)}function an(n){const{onDragover:a}=e;a&&B(a,n)}function on(n){const{onDrop:a}=e;a&&B(a,n)}function xe(){He(),ee()}function He(){fe.value=null}function ee(){Ce.value=0,ke.value=null,Z.value=null,Ke.value=null,ve()}function ve(){W&&(window.clearTimeout(W),W=null),ue=null}function re(n,a){if(e.disabled||n.disabled)return;if(e.internalUnifySelectCheck&&!e.multiple){x(n);return}const{checkedKeys:i,indeterminateKeys:c}=h.value[a?"check":"uncheck"](n.key,O.value,{cascade:e.cascade,checkStrategy:E.value,allowNotLoaded:e.allowCheckingNotLoaded});je(i,G(i)),en(c,G(c))}function l(n){if(e.disabled)return;const{value:a}=d,i=a.findIndex(c=>c===n);if(~i){const c=Array.from(a);c.splice(i,1),ge(c,G(c))}else{const c=b.value.getNode(n);if(!c||c.isLeaf)return;const p=a.concat(n);ge(p,G(p))}}function s(n){e.disabled||he.value||l(n.key)}function x(n){if(!(e.disabled||!e.selectable)){if(L.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:a,indeterminateKeys:i}}=C;e.multiple?re(n,!(a.includes(n.key)||i.includes(n.key))):je([n.key],G([n.key]))}if(e.multiple){const a=Array.from(se.value),i=a.findIndex(c=>c===n.key);~i?e.cancelable&&a.splice(i,1):~i||a.push(n.key),Ie(a,G(a))}else se.value.includes(n.key)?e.cancelable&&Ie([],[]):Ie([n.key],G([n.key]))}}function w(n){if(W&&(window.clearTimeout(W),W=null),n.isLeaf)return;ue=n.key;const a=()=>{if(ue!==n.key)return;const{value:i}=Z;if(i&&i.key===n.key&&!d.value.includes(n.key)){const c=d.value.concat(n.key);ge(c,G(c))}W=null,ue=null};n.shallowLoaded?W=window.setTimeout(()=>{a()},1e3):W=window.setTimeout(()=>{Te(n).then(()=>{a()})},1e3)}function M({event:n,node:a}){!e.draggable||e.disabled||a.disabled||(Ae({event:n,node:a},!1),nn({event:n,node:a.rawNode}))}function I({event:n,node:a}){!e.draggable||e.disabled||a.disabled||tn({event:n,node:a.rawNode})}function ie(n){n.target===n.currentTarget&&ee()}function Pe({event:n,node:a}){xe(),!(!e.draggable||e.disabled||a.disabled)&&Ve({event:n,node:a.rawNode})}function qe({event:n,node:a}){var i;!e.draggable||e.disabled||a.disabled||(Sn&&((i=n.dataTransfer)===null||i===void 0||i.setDragImage(Sn,0,0)),be=n.clientX,fe.value=a,ln({event:n,node:a.rawNode}))}function Ae({event:n,node:a},i=!0){var c;if(!e.draggable||e.disabled||a.disabled)return;const{value:p}=fe;if(!p)return;const{allowDrop:ne,indent:H}=e;i&&an({event:n,node:a.rawNode});const Be=n.currentTarget,{height:pe,top:z}=Be.getBoundingClientRect(),q=n.clientY-z;let te;ne({node:a.rawNode,dropPosition:"inside",phase:"drag"})?q<=8?te="before":q>=pe-8?te="after":te="inside":q<=pe/2?te="before":te="after";const{value:Vn}=Ze;let F,Y;const rn=Vn(a.key);if(rn===null){ee();return}let vn=!1;te==="inside"?(F=a,Y="inside"):te==="before"?a.isFirstChild?(F=a,Y="before"):(F=N.value[rn-1],Y="after"):(F=a,Y="after"),!F.isLeaf&&d.value.includes(F.key)&&(vn=!0,Y==="after"&&(F=N.value[rn+1],F?Y="before":(F=a,Y="inside")));const yn=F;if(Z.value=yn,!vn&&p.isLastChild&&p.key===F.key&&(Y="after"),Y==="after"){let mn=be-n.clientX,dn=0;for(;mn>=H/2&&F.parent!==null&&F.isLastChild&&dn<1;)mn-=H,dn+=1,F=F.parent;Ce.value=dn}else Ce.value=0;if((p.contains(F)||Y==="inside"&&((c=p.parent)===null||c===void 0?void 0:c.key)===F.key)&&!(p.key===yn.key&&p.key===F.key)){ee();return}if(!ne({node:F.rawNode,dropPosition:Y,phase:"drag"})){ee();return}if(p.key===F.key)ve();else if(ue!==F.key)if(Y==="inside"){if(e.expandOnDragenter){if(w(F),!F.shallowLoaded&&ue!==F.key){xe();return}}else if(!F.shallowLoaded){xe();return}}else ve();else Y!=="inside"&&ve();Ke.value=Y,ke.value=F}function Un({event:n,node:a,dropPosition:i}){if(!e.draggable||e.disabled||a.disabled)return;const{value:c}=fe,{value:p}=ke,{value:ne}=Ke;if(!(!c||!p||!ne)&&!!e.allowDrop({node:p.rawNode,dropPosition:ne,phase:"drag"})&&c.key!==p.key){if(ne==="before"){const H=c.getNext({includeDisabled:!0});if(H&&H.key===p.key){ee();return}}if(ne==="after"){const H=c.getPrev({includeDisabled:!0});if(H&&H.key===p.key){ee();return}}on({event:n,node:p.rawNode,dragNode:c.rawNode,dropPosition:i}),xe()}}function Mn(){Fe()}function $n(){Fe()}function zn(n){var a;if(e.virtualScroll||e.internalScrollable){const{value:i}=f;if(!((a=i==null?void 0:i.containerRef)===null||a===void 0)&&a.contains(n.relatedTarget))return;L.value=null}else{const{value:i}=r;if(i!=null&&i.contains(n.relatedTarget))return;L.value=null}}We(L,n=>{var a,i;if(n!==null){if(e.virtualScroll)(a=k.value)===null||a===void 0||a.scrollTo({key:n});else if(e.internalScrollable){const{value:c}=f;if(c===null)return;const p=(i=c.contentRef)===null||i===void 0?void 0:i.querySelector(`[data-key="${En(n)}"]`);if(!p)return;c.scrollTo({el:p})}}}),Dn(Me,{loadingKeysRef:Re,highlightKeySetRef:Ge,displayedCheckedKeysRef:O,displayedIndeterminateKeysRef:j,mergedSelectedKeysRef:se,mergedExpandedKeysRef:d,mergedThemeRef:u,mergedCheckStrategyRef:E,nodePropsRef:A(e,"nodeProps"),disabledRef:A(e,"disabled"),checkableRef:A(e,"checkable"),selectableRef:A(e,"selectable"),expandOnClickRef:A(e,"expandOnClick"),onLoadRef:A(e,"onLoad"),draggableRef:A(e,"draggable"),blockLineRef:A(e,"blockLine"),indentRef:A(e,"indent"),cascadeRef:A(e,"cascade"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Z,droppingNodeParentRef:ze,draggingNodeRef:fe,droppingPositionRef:Ke,droppingOffsetLevelRef:Ce,fNodesRef:N,pendingNodeKeyRef:L,internalScrollableRef:A(e,"internalScrollable"),internalCheckboxFocusableRef:A(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:A(e,"renderLabel"),renderPrefixRef:A(e,"renderPrefix"),renderSuffixRef:A(e,"renderSuffix"),renderSwitcherIconRef:A(e,"renderSwitcherIcon"),labelFieldRef:A(e,"labelField"),multipleRef:A(e,"multiple"),handleSwitcherClick:s,handleDragEnd:Pe,handleDragEnter:M,handleDragLeave:I,handleDragStart:qe,handleDrop:Un,handleDragOver:Ae,handleSelect:x,handleCheck:re});const jn={handleKeydown:ce},gn=T(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:a,nodeBorderRadius:i,nodeColorHover:c,nodeColorPressed:p,nodeColorActive:ne,arrowColor:H,loadingColor:Be,nodeTextColor:pe,nodeTextColorDisabled:z,dropMarkColor:q}}=u.value;return{"--n-arrow-color":H,"--n-loading-color":Be,"--n-bezier":n,"--n-font-size":a,"--n-node-border-radius":i,"--n-node-color-active":ne,"--n-node-color-hover":c,"--n-node-color-pressed":p,"--n-node-text-color":pe,"--n-node-text-color-disabled":z,"--n-drop-mark-color":q}}),Le=o?Fn("tree",void 0,gn,e):void 0;return{mergedClsPrefix:t,mergedTheme:u,fNodes:De,aip:he,selfElRef:r,virtualListInstRef:k,scrollbarInstRef:f,handleFocusout:zn,handleDragLeaveTree:ie,handleScroll:Mn,getScrollContainer:m,getScrollContent:K,handleAfterEnter:Je,handleResize:$n,handleKeydown:jn.handleKeydown,cssVars:o?void 0:gn,themeClass:Le==null?void 0:Le.themeClass,onRender:Le==null?void 0:Le.onRender}},render(){var e;const{fNodes:t,internalRenderEmpty:o}=this;if(!t.length&&o)return o();const{mergedClsPrefix:u,blockNode:r,blockLine:f,draggable:k,disabled:m,internalFocusable:K,checkable:g,handleKeydown:b,handleFocusout:y}=this,h=K&&!m,S=h?"0":void 0,R=[`${u}-tree`,g&&`${u}-tree--checkable`,(f||r)&&`${u}-tree--block-node`,f&&`${u}-tree--block-line`],_=C=>"__motion"in C?v(Et,{height:C.height,nodes:C.nodes,clsPrefix:u,mode:C.mode,onAfterEnter:this.handleAfterEnter}):v(On,{key:C.key,tmNode:C,clsPrefix:u});if(this.virtualScroll){const{mergedTheme:C,internalScrollablePadding:E}=this,O=ft(E||"0");return v(pn,{ref:"scrollbarInstRef",onDragleave:k?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:R,theme:C.peers.Scrollbar,themeOverrides:C.peerOverrides.Scrollbar,tabindex:S,onKeydown:h?b:void 0,onFocusout:h?y:void 0},{default:()=>{var j;return(j=this.onRender)===null||j===void 0||j.call(this),v(ot,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Xe,ignoreItemResize:this.aip,paddingTop:O.top,paddingBottom:O.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:O.left,paddingRight:O.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:V})=>_(V)})}})}const{internalScrollable:U}=this;return R.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),U?v(pn,{class:R,tabindex:S,onKeydown:h?b:void 0,onFocusout:h?y:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}},{default:()=>v("div",{onDragleave:k?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(_))}):v("div",{class:R,tabindex:S,ref:"selfElRef",style:this.cssVars,onKeydown:h?b:void 0,onFocusout:h?y:void 0,onDragleave:k?this.handleDragLeaveTree:void 0},t.length?t.map(_):Ln(this.$slots.empty,()=>{var C,E,O,j;return[v(Pn,{class:`${u}-tree__empty`,theme:(E=(C=this.theme)===null||C===void 0?void 0:C.peers)===null||E===void 0?void 0:E.Empty,themeOverrides:(j=(O=this.themeOverrides)===null||O===void 0?void 0:O.peers)===null||j===void 0?void 0:j.Empty})]}))}});function Rn(e,t){const{rawNode:o}=e;return Object.assign(Object.assign({},o),{label:o[t],value:e.key})}function Kn(e,t,o,u){const{rawNode:r}=e;return Object.assign(Object.assign({},r),{value:e.key,label:t.map(f=>f.rawNode[u]).join(o)})}const Ut=de([P("tree-select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),P("tree-select-menu",`
 position: relative;
 overflow: hidden;
 margin: 4px 0;
 transition: box-shadow .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-menu-border-radius);
 box-shadow: var(--n-menu-box-shadow);
 background-color: var(--n-menu-color);
 outline: none;
 `,[P("tree","max-height: var(--n-menu-height);"),ye("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),ye("action",`
 padding: var(--n-action-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),gt()])]),Mt=Object.assign(Object.assign(Object.assign(Object.assign({},Ye.props),{bordered:{type:Boolean,default:!0},cascade:Boolean,checkable:Boolean,clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},consistentMenuWidth:{type:Boolean,default:!0},defaultShow:Boolean,defaultValue:{type:[String,Number,Array],default:null},disabled:{type:Boolean,default:void 0},filterable:Boolean,checkStrategy:{type:String,default:"all"},loading:Boolean,maxTagCount:[String,Number],multiple:Boolean,showPath:Boolean,separator:{type:String,default:" / "},options:{type:Array,default:()=>[]},placeholder:String,placement:{type:String,default:"bottom-start"},show:{type:Boolean,default:void 0},size:String,value:[String,Number,Array],to:fn.propTo,menuProps:Object,virtualScroll:{type:Boolean,default:!0},status:String,renderTag:Function}),_n),{renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,onBlur:Function,onFocus:Function,onLoad:Function,onUpdateShow:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],"onUpdate:show":[Function,Array],leafOnly:Boolean}),el=me({name:"TreeSelect",props:Mt,setup(e){const t=D(null),o=D(null),u=D(null),r=D(null),{mergedClsPrefixRef:f,namespaceRef:k,inlineThemeDisabled:m}=Tn(e),{localeRef:K}=yt("Select"),{mergedSizeRef:g,mergedDisabledRef:b,mergedStatusRef:y,nTriggerFormBlur:h,nTriggerFormChange:S,nTriggerFormFocus:R,nTriggerFormInput:_}=mt(e),U=D(e.defaultValue),C=A(e,"value"),E=we(C,U),O=D(e.defaultShow),j=A(e,"show"),V=we(j,O),ae=D(""),se=T(()=>{const{filter:l}=e;if(l)return l;const{labelField:s}=e;return(x,w)=>x.length?w[s].toLowerCase().includes(x.toLowerCase()):!0}),Q=T(()=>An(e.options,Bn(e.keyField,e.childrenField))),{value:oe}=E,Se=D(e.checkable?null:Array.isArray(oe)&&oe.length?oe[oe.length-1]:null),d=T(()=>e.multiple&&e.cascade&&e.checkable),N=D(e.defaultExpandAll?void 0:e.defaultExpandedKeys||e.expandedKeys),L=A(e,"expandedKeys"),ce=we(L,N),W=D(!1),ue=T(()=>{const{placeholder:l}=e;return l!==void 0?l:K.value.placeholder}),Oe=T(()=>e.checkable?[]:$e.value),$e=T(()=>{const{value:l}=E;return e.multiple?Array.isArray(l)?l:[]:l===null||Array.isArray(l)?[]:[l]}),Ge=T(()=>{const{multiple:l,showPath:s,separator:x,labelField:w}=e;if(l)return null;const{value:M}=E;if(!Array.isArray(M)&&M!==null){const{value:I}=Q,ie=I.getNode(M);if(ie!==null)return s?Kn(ie,I.getPath(M).treeNodePath,x,w):Rn(ie,w)}return null}),Re=T(()=>{const{multiple:l,showPath:s,separator:x}=e;if(!l)return null;const{value:w}=E;if(Array.isArray(w)){const M=[],{value:I}=Q,{checkedKeys:ie}=I.getCheckedKeys(w,{checkStrategy:e.checkStrategy,cascade:d.value,allowNotLoaded:e.allowCheckingNotLoaded}),{labelField:Pe}=e;return ie.forEach(qe=>{const Ae=I.getNode(qe);Ae!==null&&M.push(s?Kn(Ae,I.getPath(qe).treeNodePath,x,Pe):Rn(Ae,Pe))}),M}return[]}),Qe=T(()=>{const{self:{menuPadding:l}}=ee.value;return l});function be(){var l;(l=o.value)===null||l===void 0||l.focus()}function fe(){var l;(l=o.value)===null||l===void 0||l.focusInput()}function ke(l){const{onUpdateShow:s,"onUpdate:show":x}=e;s&&B(s,l),x&&B(x,l),O.value=l}function Z(l,s){const{onUpdateValue:x,"onUpdate:value":w}=e;x&&B(x,l,s),w&&B(w,l,s),U.value=l,_(),S()}function Ke(l,s){const{onUpdateIndeterminateKeys:x,"onUpdate:indeterminateKeys":w}=e;x&&B(x,l,s),w&&B(w,l,s)}function Ce(l,s){const{onUpdateExpandedKeys:x,"onUpdate:expandedKeys":w}=e;x&&B(x,l,s),w&&B(w,l,s),N.value=l}function ze(l){const{onFocus:s}=e;s&&s(l),R()}function Ne(l){X();const{onBlur:s}=e;s&&s(l),h()}function X(){ke(!1)}function Te(){b.value||(ae.value="",ke(!0),e.filterable&&fe())}function he(){ae.value=""}function J(l){var s;V.value&&(!((s=o.value)===null||s===void 0)&&s.$el.contains(l.target)||X())}function Ze(){b.value||(V.value?e.filterable||X():Te())}function De(l){const{value:{getNode:s}}=Q;return l.map(x=>{var w;return((w=s(x))===null||w===void 0?void 0:w.rawNode)||null})}function Fe(l){const s=De(l);e.multiple?Z(l,s):(l.length?Z(l[0],s[0]||null):Z(null,null),X(),e.filterable||be()),e.filterable&&(fe(),e.clearFilterAfterSelect&&(ae.value=""))}function Je(l){e.checkable&&Ke(l,De(l))}function G(l){var s;!((s=r.value)===null||s===void 0)&&s.contains(l.relatedTarget)||(W.value=!0,ze(l))}function ge(l){var s;!((s=r.value)===null||s===void 0)&&s.contains(l.relatedTarget)||(W.value=!1,Ne(l))}function je(l){var s,x,w;((s=r.value)===null||s===void 0?void 0:s.contains(l.relatedTarget))||((w=(x=o.value)===null||x===void 0?void 0:x.$el)===null||w===void 0?void 0:w.contains(l.relatedTarget))||(W.value=!0,ze(l))}function en(l){var s,x,w;((s=r.value)===null||s===void 0?void 0:s.contains(l.relatedTarget))||((w=(x=o.value)===null||x===void 0?void 0:x.$el)===null||w===void 0?void 0:w.contains(l.relatedTarget))||(W.value=!1,Ne(l))}function Ie(l){l.stopPropagation();const{multiple:s}=e;!s&&e.filterable&&X(),s?Z([],[]):Z(null,null)}function nn(l){const{value:s}=E;if(Array.isArray(s)){const{value:x}=Q,{checkedKeys:w}=x.getCheckedKeys(s,{cascade:d.value,allowNotLoaded:e.allowCheckingNotLoaded}),M=w.findIndex(I=>I===l.value);if(~M)if(e.checkable){const{checkedKeys:I}=x.uncheck(l.value,w,{checkStrategy:e.checkStrategy,cascade:d.value,allowNotLoaded:e.allowCheckingNotLoaded});Z(I,De(I))}else{const I=Array.from(w);I.splice(M,1),Z(I,De(I))}}}function tn(l){const{value:s}=l.target;ae.value=s}function Ve(l){const{value:s}=u;s&&s.handleKeydown(l)}function ln(l){l.key==="Enter"?(V.value?(Ve(l),e.multiple||(X(),be())):Te(),l.preventDefault()):l.key==="Escape"?V.value&&(vt(l),X(),be()):V.value?Ve(l):l.key==="ArrowDown"&&Te()}function an(){X(),be()}function on(l){un(l,"action")||l.preventDefault()}const xe=T(()=>{const{renderTag:l}=e;if(!!l)return function({option:x,handleClose:w}){const{value:M}=x;if(M!==void 0){const I=Q.value.getNode(M);if(I)return l({option:I.rawNode,handleClose:w})}return M}});Dn(hn,{pendingNodeKeyRef:Se,dataTreeMate:Q});function He(){var l;!V.value||(l=t.value)===null||l===void 0||l.syncPosition()}it(r,He);const ee=Ye("TreeSelect","-tree-select",Ut,Kt,e,f),ve=T(()=>{const{common:{cubicBezierEaseInOut:l},self:{menuBoxShadow:s,menuBorderRadius:x,menuColor:w,menuHeight:M,actionPadding:I,actionDividerColor:ie,actionTextColor:Pe}}=ee.value;return{"--n-menu-box-shadow":s,"--n-menu-border-radius":x,"--n-menu-color":w,"--n-menu-height":M,"--n-bezier":l,"--n-action-padding":I,"--n-action-text-color":Pe,"--n-action-divider-color":ie}}),re=m?Fn("tree-select",void 0,ve,e):void 0;return{menuElRef:r,mergedStatus:y,triggerInstRef:o,followerInstRef:t,treeInstRef:u,mergedClsPrefix:f,mergedValue:E,mergedShow:V,namespace:k,adjustedTo:fn(e),isMounted:nt(),focused:W,menuPadding:Qe,mergedPlaceholder:ue,mergedExpandedKeys:ce,treeSelectedKeys:Oe,treeCheckedKeys:$e,mergedSize:g,mergedDisabled:b,selectedOption:Ge,selectedOptions:Re,pattern:ae,pendingNodeKey:Se,mergedCascade:d,mergedFilter:se,selectionRenderTag:xe,handleTriggerOrMenuResize:He,doUpdateExpandedKeys:Ce,handleMenuLeave:he,handleTriggerClick:Ze,handleMenuClickoutside:J,handleUpdateCheckedKeys:Fe,handleUpdateIndeterminateKeys:Je,handleTriggerFocus:G,handleTriggerBlur:ge,handleMenuFocusin:je,handleMenuFocusout:en,handleClear:Ie,handleDeleteOption:nn,handlePatternInput:tn,handleKeydown:ln,handleTabOut:an,handleMenuMousedown:on,mergedTheme:ee,cssVars:m?void 0:ve,themeClass:re==null?void 0:re.themeClass,onRender:re==null?void 0:re.onRender}},render(){const{mergedTheme:e,mergedClsPrefix:t,$slots:o}=this;return v("div",{class:`${t}-tree-select`},v(kt,null,{default:()=>[v(xt,null,{default:()=>v(dt,{ref:"triggerInstRef",onResize:this.handleTriggerOrMenuResize,status:this.mergedStatus,focused:this.focused,clsPrefix:t,theme:e.peers.InternalSelection,themeOverrides:e.peerOverrides.InternalSelection,renderTag:this.selectionRenderTag,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,size:this.mergedSize,bordered:this.bordered,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,active:this.mergedShow,loading:this.loading,multiple:this.multiple,maxTagCount:this.maxTagCount,showArrow:!0,filterable:this.filterable,clearable:this.clearable,pattern:this.pattern,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onDeleteOption:this.handleDeleteOption,onKeydown:this.handleKeydown},{arrow:()=>{var u,r;return[(r=(u=this.$slots).arrow)===null||r===void 0?void 0:r.call(u)]}})}),v(pt,{ref:"followerInstRef",show:this.mergedShow,placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===fn.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target"},{default:()=>v(tt,{name:"fade-in-scale-up-transition",appear:this.isMounted,onLeave:this.handleMenuLeave},{default:()=>{var u;if(!this.mergedShow)return null;const{mergedClsPrefix:r,checkable:f,multiple:k,menuProps:m,options:K}=this;return(u=this.onRender)===null||u===void 0||u.call(this),lt(v("div",Object.assign({},m,{class:[`${r}-tree-select-menu`,m==null?void 0:m.class,this.themeClass],ref:"menuElRef",style:[(m==null?void 0:m.style)||"",this.cssVars],tabindex:0,onMousedown:this.handleMenuMousedown,onKeydown:this.handleKeydown,onFocusin:this.handleMenuFocusin,onFocusout:this.handleMenuFocusout}),v(_t,{ref:"treeInstRef",blockLine:!0,allowCheckingNotLoaded:this.allowCheckingNotLoaded,showIrrelevantNodes:!1,animated:!1,pattern:this.pattern,filter:this.mergedFilter,data:K,cancelable:k,labelField:this.labelField,keyField:this.keyField,childrenField:this.childrenField,theme:e.peers.Tree,themeOverrides:e.peerOverrides.Tree,defaultExpandAll:this.defaultExpandAll,defaultExpandedKeys:this.defaultExpandedKeys,expandedKeys:this.mergedExpandedKeys,checkedKeys:this.treeCheckedKeys,selectedKeys:this.treeSelectedKeys,checkable:f,checkStrategy:this.checkStrategy,cascade:this.mergedCascade,leafOnly:this.leafOnly,multiple:this.multiple,renderLabel:this.renderLabel,renderPrefix:this.renderPrefix,renderSuffix:this.renderSuffix,renderSwitcherIcon:this.renderSwitcherIcon,nodeProps:this.nodeProps,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,internalTreeSelect:!0,internalUnifySelectCheck:!0,internalScrollable:!0,internalScrollablePadding:this.menuPadding,internalFocusable:!1,internalCheckboxFocusable:!1,internalRenderEmpty:()=>v("div",{class:`${r}-tree-select-menu__empty`},Ln(o.empty,()=>[v(Pn,{theme:e.peers.Empty,themeOverrides:e.peerOverrides.Empty})])),onLoad:this.onLoad,onUpdateCheckedKeys:this.handleUpdateCheckedKeys,onUpdateIndeterminateKeys:this.handleUpdateIndeterminateKeys,onUpdateExpandedKeys:this.doUpdateExpandedKeys}),ht(o.action,g=>g?v("div",{class:`${r}-tree-select-menu__action`,"data-action":!0},g):null),v(st,{onFocus:this.handleTabOut})),[[bt,this.handleMenuClickoutside,void 0,{capture:!0}]])}})})]}))}});export{el as N};
