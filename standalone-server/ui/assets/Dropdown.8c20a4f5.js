import{V as ye,d as me,e as ge,r as xe,N as Se,p as re}from"./Popover.374e8a7f.js";import{a as O,w as ie,d as _,t as l,y as oe,A as j,n as b,B as A,Z as L,T as Re,F as de,v as U,C as Ne,V as Pe,g as x,f as E,i as S,h as C,z as R,m as ke,l as le,s as Ke,b2 as Ie,q as D}from"./index.536c7d72.js";import{N as Ce}from"./Icon.36d6d904.js";import{C as De}from"./ChevronRight.ffdb37b1.js";import{h as Oe,c as _e}from"./Selection.2ed26059.js";import{a as $e,d as ze,p as Fe,k as Te}from"./index.8209174c.js";import{f as Ae}from"./fade-in-scale-up.cssr.1167eea7.js";import{u as je}from"./Scrollbar.7c2bcabe.js";import{u as Me}from"./use-keyboard.3c40c702.js";import{c as Y}from"./resolve-slot.12a336d2.js";function Be(e){return t=>{t?e.value=t.$el:e.value=null}}function Ee(e,t,r){if(!t)return e;const i=O(e.value);let n=null;return ie(e,u=>{n!==null&&window.clearTimeout(n),u===!0?r&&!r.value?i.value=!0:n=window.setTimeout(()=>{i.value=!0},t):i.value=!1}),i}const ae=_({name:"DropdownDivider",props:{clsPrefix:{type:String,required:!0}},render(){return l("div",{class:`${this.clsPrefix}-dropdown-divider`})}}),ne=oe("n-dropdown-menu"),q=oe("n-dropdown"),te=oe("n-dropdown-option");function ee(e,t){return e.type==="submenu"||e.type===void 0&&e[t]!==void 0}function He(e){return e.type==="group"}function se(e){return e.type==="divider"}function Le(e){return e.type==="render"}const ue=_({name:"DropdownOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null},placement:{type:String,default:"right-start"},props:Object},setup(e){const t=j(q),{hoverKeyRef:r,keyboardKeyRef:i,lastToggledSubmenuKeyRef:n,pendingKeyPathRef:u,activeKeyPathRef:f,animatedRef:c,mergedShowRef:p,renderLabelRef:y,renderIconRef:m,labelFieldRef:M,childrenFieldRef:N,renderOptionRef:$,nodePropsRef:P}=t,z=j(te,null),k=j(ne),V=b(()=>e.tmNode.rawNode),B=b(()=>{const{value:o}=N;return ee(e.tmNode.rawNode,o)}),G=b(()=>{const{disabled:o}=e.tmNode;return o}),W=b(()=>{if(!B.value)return!1;const{key:o,disabled:s}=e.tmNode;if(s)return!1;const{value:w}=r,{value:K}=i,{value:X}=n,{value:I}=u;return w!==null?I.includes(o):K!==null?I.includes(o)&&I[I.length-1]!==o:X!==null?I.includes(o):!1}),Z=b(()=>i.value===null&&!c.value),J=Ee(W,300,Z),Q=b(()=>!!(z!=null&&z.enteringSubmenuRef.value)),F=O(!1);A(te,{enteringSubmenuRef:F});function T(){F.value=!0}function H(){F.value=!1}function g(){const{parentKey:o,tmNode:s}=e;!p.value||(n.value=o,i.value=null,r.value=s.key)}function d(){const{tmNode:o}=e;!p.value||r.value!==o.key&&g()}function v(o){if(!p.value)return;const{relatedTarget:s}=o;s&&!Oe({target:s},"dropdownOption")&&(r.value=null)}function a(){const{value:o}=B,{tmNode:s}=e;!p.value||!o&&!s.disabled&&(t.doSelect(s.key,s.rawNode),t.doUpdateShow(!1))}return{labelField:M,renderLabel:y,renderIcon:m,siblingHasIcon:k.showIconRef,siblingHasSubmenu:k.hasSubmenuRef,animated:c,mergedShowSubmenu:b(()=>J.value&&!Q.value),rawNode:V,hasSubmenu:B,pending:L(()=>{const{value:o}=u,{key:s}=e.tmNode;return o.includes(s)}),childActive:L(()=>{const{value:o}=f,{key:s}=e.tmNode,w=o.findIndex(K=>s===K);return w===-1?!1:w<o.length-1}),active:L(()=>{const{value:o}=f,{key:s}=e.tmNode,w=o.findIndex(K=>s===K);return w===-1?!1:w===o.length-1}),mergedDisabled:G,renderOption:$,nodeProps:P,handleClick:a,handleMouseMove:d,handleMouseEnter:g,handleMouseLeave:v,handleSubmenuBeforeEnter:T,handleSubmenuAfterEnter:H}},render(){var e;const{animated:t,rawNode:r,mergedShowSubmenu:i,clsPrefix:n,siblingHasIcon:u,siblingHasSubmenu:f,renderLabel:c,renderIcon:p,renderOption:y,nodeProps:m,props:M}=this,N=i?l(ce,{clsPrefix:n,tmNodes:this.tmNode.children,parentKey:this.tmNode.key}):null,$={class:[`${n}-dropdown-option-body`,this.pending&&`${n}-dropdown-option-body--pending`,this.active&&`${n}-dropdown-option-body--active`,this.childActive&&`${n}-dropdown-option-body--child-active`,this.mergedDisabled&&`${n}-dropdown-option-body--disabled`],onMousemove:this.handleMouseMove,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onClick:this.handleClick},P=l("div",Object.assign({class:`${n}-dropdown-option`},m==null?void 0:m(r)),l("div",de($,M),[l("div",{"data-dropdown-option":!0,class:[`${n}-dropdown-option-body__prefix`,u&&`${n}-dropdown-option-body__prefix--show-icon`]},[p?p(r):U(r.icon)]),l("div",{"data-dropdown-option":!0,class:`${n}-dropdown-option-body__label`},c?c(r):U((e=r[this.labelField])!==null&&e!==void 0?e:r.title)),l("div",{"data-dropdown-option":!0,class:[`${n}-dropdown-option-body__suffix`,f&&`${n}-dropdown-option-body__suffix--has-submenu`]},this.hasSubmenu?l(Ce,null,{default:()=>l(De,null)}):null)]),this.hasSubmenu?l(ye,null,{default:()=>[l(me,null,{default:()=>l("div",{class:`${n}-dropdown-offset-container`},l(ge,{show:this.mergedShowSubmenu,placement:this.placement,teleportDisabled:!0},{default:()=>l("div",{class:`${n}-dropdown-menu-wrapper`},t?l(Re,{onBeforeEnter:this.handleSubmenuBeforeEnter,onAfterEnter:this.handleSubmenuAfterEnter,name:"fade-in-scale-up-transition",appear:!0},{default:()=>N}):N)}))})]}):null);return y?y({node:P,option:r}):P}}),Ue=_({name:"DropdownGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{showIconRef:e,hasSubmenuRef:t}=j(ne),{renderLabelRef:r,labelFieldRef:i,nodePropsRef:n,renderOptionRef:u}=j(q);return{labelField:i,showIcon:e,hasSubmenu:t,renderLabel:r,nodeProps:n,renderOption:u}},render(){var e;const{clsPrefix:t,hasSubmenu:r,showIcon:i,nodeProps:n,renderLabel:u,renderOption:f}=this,{rawNode:c}=this.tmNode,p=l("div",Object.assign({class:`${t}-dropdown-option`},n==null?void 0:n(c)),l("div",{class:`${t}-dropdown-option-body ${t}-dropdown-option-body--group`},l("div",{"data-dropdown-option":!0,class:[`${t}-dropdown-option-body__prefix`,i&&`${t}-dropdown-option-body__prefix--show-icon`]},U(c.icon)),l("div",{class:`${t}-dropdown-option-body__label`,"data-dropdown-option":!0},u?u(c):U((e=c.title)!==null&&e!==void 0?e:c[this.labelField])),l("div",{class:[`${t}-dropdown-option-body__suffix`,r&&`${t}-dropdown-option-body__suffix--has-submenu`],"data-dropdown-option":!0})));return f?f({node:p,option:c}):p}}),qe=_({name:"NDropdownGroup",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null}},render(){const{tmNode:e,parentKey:t,clsPrefix:r}=this,{children:i}=e;return l(Pe,null,l(Ue,{clsPrefix:r,tmNode:e,key:e.key}),i==null?void 0:i.map(n=>se(n.rawNode)?l(ae,{clsPrefix:r,key:n.key}):n.isGroup?(Ne("dropdown","`group` node is not allowed to be put in `group` node."),null):l(ue,{clsPrefix:r,tmNode:n,parentKey:t,key:n.key})))}}),Ve=_({name:"DropdownRenderOption",props:{tmNode:{type:Object,required:!0}},render(){const{rawNode:{render:e,props:t}}=this.tmNode;return l("div",t,[e==null?void 0:e()])}}),ce=_({name:"DropdownMenu",props:{showArrow:Boolean,arrowStyle:[String,Object],clsPrefix:{type:String,required:!0},tmNodes:{type:Array,default:()=>[]},parentKey:{type:[String,Number],default:null}},setup(e){const{renderIconRef:t,childrenFieldRef:r}=j(q);A(ne,{showIconRef:b(()=>{const n=t.value;return e.tmNodes.some(u=>{var f;if(u.isGroup)return(f=u.children)===null||f===void 0?void 0:f.some(({rawNode:p})=>n?n(p):p.icon);const{rawNode:c}=u;return n?n(c):c.icon})}),hasSubmenuRef:b(()=>{const{value:n}=r;return e.tmNodes.some(u=>{var f;if(u.isGroup)return(f=u.children)===null||f===void 0?void 0:f.some(({rawNode:p})=>ee(p,n));const{rawNode:c}=u;return ee(c,n)})})});const i=O(null);return A($e,null),A(ze,null),A(Fe,i),{bodyRef:i}},render(){const{parentKey:e,clsPrefix:t}=this;return l("div",{class:`${t}-dropdown-menu`,ref:"bodyRef"},this.tmNodes.map(r=>{const{rawNode:i}=r;return Le(i)?l(Ve,{tmNode:r,key:r.key}):se(i)?l(ae,{clsPrefix:t,key:r.key}):He(i)?l(qe,{clsPrefix:t,tmNode:r,parentKey:e,key:r.key}):l(ue,{clsPrefix:t,tmNode:r,parentKey:e,key:r.key,props:i.props})}),this.showArrow?xe({clsPrefix:t,arrowStyle:this.arrowStyle}):null)}}),Ge=x("dropdown-menu",`
 transform-origin: inherit;
 padding: var(--n-padding);
 background-color: var(--n-color);
 border-radius: var(--n-border-radius);
 box-shadow: var(--n-box-shadow);
 position: relative;
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
`,[Ae(),x("dropdown-option",`
 position: relative;
 `,[E("a",`
 text-decoration: none;
 color: inherit;
 outline: none;
 `,[E("&::before",`
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),x("dropdown-option-body",`
 display: flex;
 cursor: pointer;
 position: relative;
 height: var(--n-option-height);
 line-height: var(--n-option-height);
 font-size: var(--n-font-size);
 color: var(--n-option-text-color);
 transition: color .3s var(--n-bezier);
 `,[E("&::before",`
 content: "";
 position: absolute;
 top: 0;
 bottom: 0;
 left: 4px;
 right: 4px;
 transition: background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 `),S("pending",{color:"var(--n-option-text-color-hover)"},[C("prefix, suffix",{color:"var(--n-option-text-color-hover)"}),E("&::before","background-color: var(--n-option-color-hover);")]),S("active",{color:"var(--n-option-text-color-active)"},[C("prefix, suffix",{color:"var(--n-option-text-color-active)"}),E("&::before","background-color: var(--n-option-color-active);")]),S("disabled",{cursor:"not-allowed",opacity:"var(--n-option-opacity-disabled)"}),S("child-active",{color:"var(--n-option-text-color-child-active)"},[C("prefix, suffix",{color:"var(--n-option-text-color-child-active)"})]),S("group",{fontSize:"calc(var(--n-font-size) - 1px)",color:"var(--n-group-header-text-color)"},[C("prefix",{width:"calc(var(--n-option-prefix-width) / 2)"},[S("show-icon",{width:"calc(var(--n-option-icon-prefix-width) / 2)"})])]),C("prefix",`
 width: var(--n-option-prefix-width);
 display: flex;
 justify-content: center;
 align-items: center;
 color: var(--n-prefix-color);
 transition: color .3s var(--n-bezier);
 `,[S("show-icon",{width:"var(--n-option-icon-prefix-width)"}),x("icon",{fontSize:"var(--n-option-icon-size)"})]),C("label",`
 white-space: nowrap;
 flex: 1;
 z-index: 1;
 `),C("suffix",`
 box-sizing: border-box;
 flex-grow: 0;
 flex-shrink: 0;
 display: flex;
 justify-content: flex-end;
 align-items: center;
 min-width: var(--n-option-suffix-width);
 padding: 0 8px;
 transition: color .3s var(--n-bezier);
 color: var(--n-suffix-color);
 `,[S("has-submenu",{width:"var(--n-option-icon-suffix-width)"}),x("icon",{fontSize:"var(--n-option-icon-size)"})]),x("dropdown-menu","pointer-events: all;")]),x("dropdown-offset-container",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: -4px;
 bottom: -4px;
 `)]),x("dropdown-divider",`
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-divider-color);
 height: 1px;
 margin: 4px 0;
 `),x("dropdown-menu-wrapper",`
 transform-origin: inherit;
 width: fit-content;
 `)]),We={animated:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},size:{type:String,default:"medium"},inverted:Boolean,placement:{type:String,default:"bottom"},onSelect:[Function,Array],options:{type:Array,default:()=>[]},showArrow:Boolean,renderLabel:Function,renderIcon:Function,renderOption:Function,nodeProps:Function,labelField:{type:String,default:"label"},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},value:[String,Number]},Ze=Object.keys(re),Je=Object.assign(Object.assign(Object.assign({},re),We),le.props),ao=_({name:"Dropdown",inheritAttrs:!1,props:Je,setup(e){const t=O(!1),r=je(R(e,"show"),t),i=b(()=>{const{keyField:d,childrenField:v}=e;return _e(e.options,{getKey(a){return a[d]},getDisabled(a){return a.disabled===!0},getIgnored(a){return a.type==="divider"||a.type==="render"},getChildren(a){return a[v]}})}),n=b(()=>i.value.treeNodes),u=O(null),f=O(null),c=O(null),p=b(()=>{var d,v,a;return(a=(v=(d=u.value)!==null&&d!==void 0?d:f.value)!==null&&v!==void 0?v:c.value)!==null&&a!==void 0?a:null}),y=b(()=>i.value.getPath(p.value).keyPath),m=b(()=>i.value.getPath(e.value).keyPath),M=L(()=>e.keyboard&&r.value);Me({keydown:{ArrowUp:{prevent:!0,handler:Z},ArrowRight:{prevent:!0,handler:W},ArrowDown:{prevent:!0,handler:J},ArrowLeft:{prevent:!0,handler:G},Escape:B},keyup:{Enter:Q}},M);const{mergedClsPrefixRef:N,inlineThemeDisabled:$}=ke(e),P=le("Dropdown","-dropdown",Ge,Ie,e,N);A(q,{labelFieldRef:R(e,"labelField"),childrenFieldRef:R(e,"childrenField"),renderLabelRef:R(e,"renderLabel"),renderIconRef:R(e,"renderIcon"),hoverKeyRef:u,keyboardKeyRef:f,lastToggledSubmenuKeyRef:c,pendingKeyPathRef:y,activeKeyPathRef:m,animatedRef:R(e,"animated"),mergedShowRef:r,nodePropsRef:R(e,"nodeProps"),renderOptionRef:R(e,"renderOption"),doSelect:z,doUpdateShow:k}),ie(r,d=>{d||V()});function z(d,v){const{onSelect:a}=e;a&&Y(a,d,v)}function k(d){const{"onUpdate:show":v,onUpdateShow:a}=e;v&&Y(v,d),a&&Y(a,d),t.value=d}function V(){u.value=null,f.value=null,c.value=null}function B(){k(!1)}function G(){T("left")}function W(){T("right")}function Z(){T("up")}function J(){T("down")}function Q(){const d=F();d!=null&&d.isLeaf&&(z(d.key,d.rawNode),k(!1))}function F(){var d;const{value:v}=i,{value:a}=p;return!v||a===null?null:(d=v.getNode(a))!==null&&d!==void 0?d:null}function T(d){const{value:v}=p,{value:{getFirstAvailableNode:a}}=i;let o=null;if(v===null){const s=a();s!==null&&(o=s.key)}else{const s=F();if(s){let w;switch(d){case"down":w=s.getNext();break;case"up":w=s.getPrev();break;case"right":w=s.getChild();break;case"left":w=s.getParent();break}w&&(o=w.key)}}o!==null&&(u.value=null,f.value=o)}const H=b(()=>{const{size:d,inverted:v}=e,{common:{cubicBezierEaseInOut:a},self:o}=P.value,{padding:s,dividerColor:w,borderRadius:K,optionOpacityDisabled:X,[D("optionIconSuffixWidth",d)]:I,[D("optionSuffixWidth",d)]:pe,[D("optionIconPrefixWidth",d)]:fe,[D("optionPrefixWidth",d)]:he,[D("fontSize",d)]:ve,[D("optionHeight",d)]:we,[D("optionIconSize",d)]:be}=o,h={"--n-bezier":a,"--n-font-size":ve,"--n-padding":s,"--n-border-radius":K,"--n-option-height":we,"--n-option-prefix-width":he,"--n-option-icon-prefix-width":fe,"--n-option-suffix-width":pe,"--n-option-icon-suffix-width":I,"--n-option-icon-size":be,"--n-divider-color":w,"--n-option-opacity-disabled":X};return v?(h["--n-color"]=o.colorInverted,h["--n-option-color-hover"]=o.optionColorHoverInverted,h["--n-option-color-active"]=o.optionColorActiveInverted,h["--n-option-text-color"]=o.optionTextColorInverted,h["--n-option-text-color-hover"]=o.optionTextColorHoverInverted,h["--n-option-text-color-active"]=o.optionTextColorActiveInverted,h["--n-option-text-color-child-active"]=o.optionTextColorChildActiveInverted,h["--n-prefix-color"]=o.prefixColorInverted,h["--n-suffix-color"]=o.suffixColorInverted,h["--n-group-header-text-color"]=o.groupHeaderTextColorInverted):(h["--n-color"]=o.color,h["--n-option-color-hover"]=o.optionColorHover,h["--n-option-color-active"]=o.optionColorActive,h["--n-option-text-color"]=o.optionTextColor,h["--n-option-text-color-hover"]=o.optionTextColorHover,h["--n-option-text-color-active"]=o.optionTextColorActive,h["--n-option-text-color-child-active"]=o.optionTextColorChildActive,h["--n-prefix-color"]=o.prefixColor,h["--n-suffix-color"]=o.suffixColor,h["--n-group-header-text-color"]=o.groupHeaderTextColor),h}),g=$?Ke("dropdown",b(()=>`${e.size[0]}${e.inverted?"i":""}`),H,e):void 0;return{mergedClsPrefix:N,mergedTheme:P,tmNodes:n,mergedShow:r,doUpdateShow:k,cssVars:$?void 0:H,themeClass:g==null?void 0:g.themeClass,onRender:g==null?void 0:g.onRender}},render(){const e=(i,n,u,f,c)=>{var p;const{mergedClsPrefix:y}=this;(p=this.onRender)===null||p===void 0||p.call(this);const m={ref:Be(n),class:[i,`${y}-dropdown`,this.themeClass],clsPrefix:y,tmNodes:this.tmNodes,style:[u,this.cssVars],showArrow:this.showArrow,arrowStyle:this.arrowStyle,onMouseenter:f,onMouseleave:c};return l(ce,de(this.$attrs,m))},{mergedTheme:t}=this,r={show:this.mergedShow,theme:t.peers.Popover,themeOverrides:t.peerOverrides.Popover,internalRenderBody:e,onUpdateShow:this.doUpdateShow,"onUpdate:show":void 0};return l(Se,Object.assign({},Te(this.$props,Ze),r),{trigger:()=>{var i,n;return(n=(i=this.$slots).default)===null||n===void 0?void 0:n.call(i)}})}});export{ao as N,Be as c};
