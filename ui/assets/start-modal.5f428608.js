import{d as H,a as B,u as K,n as z,at as J,e as Y,w as q,ba as g,c as e,t as O,bJ as Q,F as X,ak as Z}from"./index.536c7d72.js";import{M as $}from"./index.4d9d5980.js";import{u as ee,a as te}from"./use-modal.50ac9826.js";import{A as L,a as U}from"./ArrowUpOutlined.6047a6cd.js";import{P as M}from"./PlusCircleOutlined.da9dc67f.js";import{D as ae}from"./DeleteOutlined.0c0bc8fc.js";import{N as j}from"./Icon.36d6d904.js";import{N as re}from"./Form.b918a62f.js";import{N as o}from"./FormItem.67716b88.js";import{N as F}from"./RadioGroup.5a44255f.js";import{N as m}from"./Space.8c5cfc39.js";import{N as u}from"./Radio.8f1c774c.js";import{a as T}from"./Select.eddb521d.js";import{a as R}from"./Checkbox.9b98fe51.js";import{N as P}from"./Input.4b8b409e.js";import{N as oe}from"./RadioButton.c57a94c4.js";import{N as le}from"./DatePicker.9d2907ba.js";import{N as E}from"./Button.9dd5ee3c.js";import{N as se}from"./Switch.57a995f1.js";const ne="_startup_14f40_17",ue="_formItem_14f40_24",N={startup:ne,formItem:ue};function l(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!Z(r)}const ie={row:{type:Object,default:{}},show:{type:Boolean,default:!1},taskCode:{type:String}},pe=H({name:"workflowDefinitionStart",props:ie,emits:["update:show","update:row","updateList"],setup(r,c){var D;const f=B(!1),{t:s}=K(),w=Q(),{startState:i}=ee(),{variables:n,handleStartDefinition:h,getWorkerGroups:_,getAlertGroups:k,getEnvironmentList:v,getStartParamsList:b}=te(i,c),y=()=>{c.emit("update:show")},a=()=>{h(r.row.code)},t=()=>[{value:"NONE",label:s("project.workflow.none_send")},{value:"SUCCESS",label:s("project.workflow.success_send")},{value:"FAILURE",label:s("project.workflow.failure_send")},{value:"ALL",label:s("project.workflow.all_send")}],p=()=>[{value:"HIGHEST",label:"HIGHEST",color:"#ff0000",icon:L},{value:"HIGH",label:"HIGH",color:"#ff0000",icon:L},{value:"MEDIUM",label:"MEDIUM",color:"#EA7D24",icon:L},{value:"LOW",label:"LOW",color:"#2A8734",icon:U},{value:"LOWEST",label:"LOWEST",color:"#2A8734",icon:U}],S=z(()=>w.name==="workflow-definition-detail"),A=d=>[O(j,{style:{verticalAlign:"middle",marginRight:"4px",marginBottom:"3px"},color:d.color},{default:()=>O(d.icon)}),d.label],C=()=>{i.startForm.environmentCode=null},x=()=>{n.startParamsList.push({prop:"",value:""})},G=(d,I)=>{n.startParamsList[d].prop=I[0],n.startParamsList[d].value=I[1]},V=d=>{n.startParamsList.splice(d,1)},W=(D=J())==null?void 0:D.appContext.config.globalProperties.trim;return Y(()=>{_(),k(),v()}),q(()=>r.show,()=>{r.show&&(b(r.row.code),r.taskCode&&(i.startForm.startNodeList=r.taskCode))}),{t:s,showTaskDependType:S,parallelismRef:f,hideModal:y,handleStart:a,generalWarningTypeListOptions:t,generalPriorityList:p,renderLabel:A,updateWorkerGroup:C,removeStartParams:V,addStartParams:x,updateParamsList:G,...g(n),...g(i),...g(r),trim:W}},render(){let r,c,f,s,w,i,n,h,_,k,v,b,y;const{t:a}=this;return e($,{show:this.show,title:a("project.workflow.set_parameters_before_starting"),onCancel:this.hideModal,onConfirm:this.handleStart,confirmLoading:this.saving},{default:()=>[e(re,{ref:"startFormRef",model:this.startForm,rules:this.rules},{default:()=>[e(o,{label:a("project.workflow.workflow_name"),path:"workflow_name"},{default:()=>[e("div",{class:N.formItem,title:this.row.name},[this.row.name])]}),e(o,{label:a("project.workflow.failure_strategy"),path:"failureStrategy"},{default:()=>[e(F,{value:this.startForm.failureStrategy,"onUpdate:value":t=>this.startForm.failureStrategy=t},{default:()=>[e(m,null,{default:()=>[e(u,{value:"CONTINUE"},l(r=a("project.workflow.continue"))?r:{default:()=>[r]}),e(u,{value:"END"},l(c=a("project.workflow.end"))?c:{default:()=>[c]})]})]})]}),this.showTaskDependType&&e(o,{label:a("project.workflow.node_execution"),path:"taskDependType"},{default:()=>[e(F,{value:this.startForm.taskDependType,"onUpdate:value":t=>this.startForm.taskDependType=t},{default:()=>[e(m,null,{default:()=>[e(u,{value:"TASK_POST"},l(f=a("project.workflow.backward_execution"))?f:{default:()=>[f]}),e(u,{value:"TASK_PRE"},l(s=a("project.workflow.forward_execution"))?s:{default:()=>[s]}),e(u,{value:"TASK_ONLY"},l(w=a("project.workflow.current_node_execution"))?w:{default:()=>[w]})]})]})]}),e(o,{label:a("project.workflow.notification_strategy"),path:"warningType"},{default:()=>[e(T,{options:this.generalWarningTypeListOptions(),value:this.startForm.warningType,"onUpdate:value":t=>this.startForm.warningType=t},null)]}),e(o,{label:a("project.workflow.workflow_priority"),path:"processInstancePriority"},{default:()=>[e(T,{options:this.generalPriorityList(),renderLabel:this.renderLabel,value:this.startForm.processInstancePriority,"onUpdate:value":t=>this.startForm.processInstancePriority=t},null)]}),e(o,{label:a("project.workflow.worker_group"),path:"workerGroup"},{default:()=>[e(T,{options:this.workerGroups,onUpdateValue:this.updateWorkerGroup,value:this.startForm.workerGroup,"onUpdate:value":t=>this.startForm.workerGroup=t},null)]}),e(o,{label:a("project.workflow.environment_name"),path:"environmentCode"},{default:()=>[e(T,{options:this.environmentList.filter(t=>{var p;return(p=t.workerGroups)==null?void 0:p.includes(this.startForm.workerGroup)}),value:this.startForm.environmentCode,"onUpdate:value":t=>this.startForm.environmentCode=t,clearable:!0},null)]}),e(o,{label:a("project.workflow.alarm_group"),path:"warningGroupId"},{default:()=>[e(T,{options:this.alertGroups,placeholder:a("project.workflow.please_choose"),value:this.startForm.warningGroupId,"onUpdate:value":t=>this.startForm.warningGroupId=t,clearable:!0},null)]}),e(o,{label:a("project.workflow.complement_data"),path:"complement_data"},{default:()=>[e(R,{checkedValue:"COMPLEMENT_DATA",uncheckedValue:"START_PROCESS",checked:this.startForm.execType,"onUpdate:checked":t=>this.startForm.execType=t},l(i=a("project.workflow.whether_complement_data"))?i:{default:()=>[i]})]}),this.startForm.execType&&this.startForm.execType!=="START_PROCESS"&&e(m,{vertical:!0,class:N["width-100"]},{default:()=>[e(o,{label:a("project.workflow.mode_of_dependent"),path:"complementDependentMode"},{default:()=>[e(F,{value:this.startForm.complementDependentMode,"onUpdate:value":t=>this.startForm.complementDependentMode=t},{default:()=>[e(m,null,{default:()=>[e(u,{value:"OFF_MODE"},l(n=a("project.workflow.close"))?n:{default:()=>[n]}),e(u,{value:"ALL_DEPENDENT"},l(h=a("project.workflow.open"))?h:{default:()=>[h]})]})]})]}),e(o,{label:a("project.workflow.mode_of_execution"),path:"runMode"},{default:()=>[e(F,{value:this.startForm.runMode,"onUpdate:value":t=>this.startForm.runMode=t},{default:()=>[e(m,null,{default:()=>[e(u,{value:"RUN_MODE_SERIAL"},l(_=a("project.workflow.serial_execution"))?_:{default:()=>[_]}),e(u,{value:"RUN_MODE_PARALLEL"},l(k=a("project.workflow.parallel_execution"))?k:{default:()=>[k]})]})]})]}),this.startForm.runMode==="RUN_MODE_PARALLEL"&&e(o,{label:a("project.workflow.parallelism"),path:"expectedParallelismNumber"},{default:()=>[e(R,{checked:this.parallelismRef,"onUpdate:checked":t=>this.parallelismRef=t},l(v=a("project.workflow.custom_parallelism"))?v:{default:()=>[v]}),e(P,{allowInput:this.trim,disabled:!this.parallelismRef,placeholder:a("project.workflow.please_enter_parallelism"),value:this.startForm.expectedParallelismNumber,"onUpdate:value":t=>this.startForm.expectedParallelismNumber=t},null)]}),e(o,{label:a("project.workflow.schedule_date"),path:this.startForm.dataDateType===1?"startEndTime":"scheduleTime"},{default:()=>[e(m,{vertical:!0,class:N["width-100"]},{default:()=>[e(F,{name:"data-date",value:this.startForm.dataDateType,"onUpdate:value":t=>this.startForm.dataDateType=t},l(b=[{label:a("project.workflow.select_date"),value:1},{label:a("project.workflow.enter_date"),value:2}].map(t=>e(oe,X(t,{key:t.value}),null)))?b:{default:()=>[b]}),this.startForm.dataDateType===1?e(le,{type:"datetimerange",clearable:!0,value:this.startForm.startEndTime,"onUpdate:value":t=>this.startForm.startEndTime=t,placement:"top"},null):e(P,{allowInput:this.trim,clearable:!0,type:"textarea",value:this.startForm.scheduleTime,"onUpdate:value":t=>this.startForm.scheduleTime=t,placeholder:a("project.workflow.schedule_date_tips")},null)]})]})]}),e(o,{label:a("project.workflow.startup_parameter"),path:"startup_parameter"},{default:()=>[this.startParamsList.length===0?e(E,{text:!0,type:"primary",onClick:this.addStartParams},{default:()=>[e(j,null,{default:()=>[e(M,null,null)]})]}):e(m,{vertical:!0},l(y=this.startParamsList.map((t,p)=>e(m,{class:N.startup,key:Date.now()+p},{default:()=>[e(P,{allowInput:this.trim,pair:!0,separator:":",placeholder:["prop","value"],defaultValue:[t.prop,t.value],onUpdateValue:S=>this.updateParamsList(p,S)},null),e(E,{text:!0,type:"error",onClick:()=>this.removeStartParams(p),class:"btn-delete-custom-parameter"},{default:()=>[e(j,null,{default:()=>[e(ae,null,null)]})]}),e(E,{text:!0,type:"primary",onClick:this.addStartParams,class:"btn-create-custom-parameter"},{default:()=>[e(j,null,{default:()=>[e(M,null,null)]})]})]})))?y:{default:()=>[y]})]}),e(o,{label:a("project.workflow.whether_dry_run"),path:"dryRun"},{default:()=>[e(se,{checkedValue:1,uncheckedValue:0,value:this.startForm.dryRun,"onUpdate:value":t=>this.startForm.dryRun=t},null)]})]})]})}}),Ee=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{pe as S,Ee as a,N as s};
