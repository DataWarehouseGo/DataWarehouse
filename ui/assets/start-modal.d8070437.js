import{d as F,u as P,at as G,e as I,w as U,ba as p,c as t,ak as O}from"./index.536c7d72.js";import{M as V}from"./index.4d9d5980.js";import{useStart as M}from"./use-start.cce1fa75.js";import{P as h}from"./PlusCircleOutlined.da9dc67f.js";import{D as R}from"./DeleteOutlined.0c0bc8fc.js";import{N as D}from"./Form.b918a62f.js";import{N as s}from"./FormItem.67716b88.js";import{a as l}from"./Select.eddb521d.js";import{N as u}from"./Button.9dd5ee3c.js";import{N as m}from"./Icon.36d6d904.js";import{N as f}from"./Space.8c5cfc39.js";import{N as T}from"./Input.4b8b409e.js";import{N as W}from"./Switch.57a995f1.js";import"./index.eb38a2cf.js";import"./keysOf.10525521.js";import"./Card.1fac8dc8.js";import"./use-rtl.b3456902.js";import"./resolve-slot.12a336d2.js";import"./index.7a579f81.js";import"./index.8209174c.js";import"./flatten.f4456e1c.js";import"./Scrollbar.7c2bcabe.js";import"./fade-in.cssr.ef9eaee7.js";import"./VResizeObserver.0aad584a.js";import"./fade-in-scale-up.cssr.1167eea7.js";import"./utils.ba7f47bf.js";import"./is-browser.f4bc45cf.js";import"./index.d67d1729.js";import"./service.4ca56d82.js";import"./lodash.bce5b897.js";import"./index.22428b53.js";import"./index.5b6233e7.js";import"./index.5342f370.js";import"./index.393f36dd.js";import"./format-length.a0cbed4d.js";import"./use-locale.31127f4e.js";import"./use-compitable.7f10f89e.js";import"./Selection.2ed26059.js";import"./Popover.374e8a7f.js";import"./next-frame-once.e5ee25e8.js";import"./Suffix.4fa63b0d.js";import"./get-slot.7f666ba0.js";function E(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!O(a)}const A={row:{type:Object,default:{}},show:{type:Boolean,default:!1},taskCode:{type:String}},Gt=F({name:"task-definition-start",props:A,emits:["update:show","update:row","updateList"],setup(a,o){var d;const{t:r}=P(),{variables:e,handleStartDefinition:n,getWorkerGroups:k,getAlertGroups:w,getEnvironmentList:v,getStartParamsList:g}=M(o),S=()=>[{value:"NONE",label:r("project.task.none_send")},{value:"SUCCESS",label:r("project.task.success_send")},{value:"FAILURE",label:r("project.task.failure_send")},{value:"ALL",label:r("project.task.all_send")}],b=()=>{o.emit("update:show")},y=()=>{n(a.row.taskCode)},N=()=>{e.startForm.environmentCode=null},_=()=>{e.startState.startParamsList.push({prop:"",value:""})},C=(i,c)=>{e.startState.startParamsList[i].prop=c[0],e.startState.startParamsList[i].value=c[1]},L=i=>{e.startState.startParamsList.splice(i,1)},j=(d=G())==null?void 0:d.appContext.config.globalProperties.trim;return I(()=>{k(),w(),v()}),U(()=>a.show,()=>{a.show&&g(a.row.processDefinitionCode)}),{t:r,hideModal:b,handleStart:y,updateWorkerGroup:N,removeStartParams:L,addStartParams:_,updateParamsList:C,generalWarningTypeListOptions:S,...p(e),...p(e.startState),...p(a),trim:j}},render(){let a;const{t:o}=this;return t(V,{show:this.show,title:o("project.task.set_parameters_before_starting"),onCancel:this.hideModal,onConfirm:this.handleStart,confirmLoading:this.saving},{default:()=>[t(D,{ref:"startFormRef",model:this.startForm},{default:()=>[t(s,{label:o("project.task.task_name"),path:"task_name"},{default:()=>[t("div",{title:this.row.taskName},[this.row.taskName])]}),t(s,{label:o("project.task.notification_strategy"),path:"warningType"},{default:()=>[t(l,{options:this.generalWarningTypeListOptions(),value:this.startForm.warningType,"onUpdate:value":r=>this.startForm.warningType=r},null)]}),t(s,{label:o("project.task.worker_group"),path:"workerGroup"},{default:()=>[t(l,{options:this.workerGroups,onUpdateValue:this.updateWorkerGroup,value:this.startForm.workerGroup,"onUpdate:value":r=>this.startForm.workerGroup=r},null)]}),t(s,{label:o("project.task.environment_name"),path:"environmentCode"},{default:()=>[t(l,{options:this.environmentList.filter(r=>{var e;return(e=r.workerGroups)==null?void 0:e.includes(this.startForm.workerGroup)}),value:this.startForm.environmentCode,"onUpdate:value":r=>this.startForm.environmentCode=r,clearable:!0},null)]}),t(s,{label:o("project.task.alarm_group"),path:"warningGroupId"},{default:()=>[t(l,{options:this.alertGroups,placeholder:o("project.task.please_choose"),value:this.startForm.warningGroupId,"onUpdate:value":r=>this.startForm.warningGroupId=r,clearable:!0},null)]}),t(s,{label:o("project.task.startup_parameter"),path:"startup_parameter"},{default:()=>[this.startParamsList.length===0?t(u,{text:!0,type:"primary",onClick:this.addStartParams},{default:()=>[t(m,null,{default:()=>[t(h,null,null)]})]}):t(f,{vertical:!0},E(a=this.startParamsList.map((r,e)=>t(f,{key:Date.now()+e},{default:()=>[t(T,{allowInput:this.trim,pair:!0,separator:":",placeholder:["prop","value"],defaultValue:[r.prop,r.value],onUpdateValue:n=>this.updateParamsList(e,n)},null),t(u,{text:!0,type:"error",onClick:()=>this.removeStartParams(e),class:"btn-delete-custom-parameter"},{default:()=>[t(m,null,{default:()=>[t(R,null,null)]})]}),t(u,{text:!0,type:"primary",onClick:this.addStartParams,class:"btn-create-custom-parameter"},{default:()=>[t(m,null,{default:()=>[t(h,null,null)]})]})]})))?a:{default:()=>[a]})]}),t(s,{label:o("project.task.whether_dry_run"),path:"dryRun"},{default:()=>[t(W,{checkedValue:1,uncheckedValue:0,value:this.startForm.dryRun,"onUpdate:value":r=>this.startForm.dryRun=r},null)]})]})]})}});export{Gt as default};
