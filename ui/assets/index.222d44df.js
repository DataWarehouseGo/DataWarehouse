import{d as k,b7 as h,b8 as g,b9 as C,b5 as b,a as m,u as _,e as N,w as j,ba as y,c as t,bJ as W}from"./index.536c7d72.js";import{u as w}from"./index.990798b2.js";import{s as u}from"./service.4ca56d82.js";import{C as v}from"./index.67b00418.js";import F from"./Graph.b5ad6593.js";import{R as D}from"./index.acfd4125.js";import{R}from"./ReloadOutlined.ce4b3a08.js";import{N as S}from"./Space.8c5cfc39.js";import{a as O}from"./Select.eddb521d.js";import{N as p}from"./Tooltip.2dc588a0.js";import{N as f}from"./Button.9dd5ee3c.js";import{N as d}from"./Icon.36d6d904.js";import"./lodash.bce5b897.js";import"./Card.1fac8dc8.js";import"./use-rtl.b3456902.js";import"./resolve-slot.12a336d2.js";import"./index.7a579f81.js";import"./keysOf.10525521.js";import"./index.d67ddc9d.js";import"./is-browser.f4bc45cf.js";import"./flatten.f4456e1c.js";import"./get-slot.7f666ba0.js";import"./fade-in-scale-up.cssr.1167eea7.js";import"./Scrollbar.7c2bcabe.js";import"./fade-in.cssr.ef9eaee7.js";import"./VResizeObserver.0aad584a.js";import"./use-locale.31127f4e.js";import"./use-compitable.7f10f89e.js";import"./Selection.2ed26059.js";import"./Popover.374e8a7f.js";import"./index.8209174c.js";import"./utils.ba7f47bf.js";import"./format-length.a0cbed4d.js";import"./next-frame-once.e5ee25e8.js";import"./Suffix.4fa63b0d.js";const x={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},L=C("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3c7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112s112 50.1 112 112s-50.1 112-112 112z",fill:"currentColor"},null,-1),B=[L],z=k({name:"EyeOutlined",render:function(l,s){return h(),g("svg",x,B)}});function q(o){return u({url:`/projects/${o.projectCode}/lineages/list`,method:"get"})}function $(o){return u({url:`/projects/${o.projectCode}/lineages/query-by-name`,method:"get"})}function E(o,l){return u({url:`/projects/${l.projectCode}/lineages/${o.workFlowCode}`,method:"get"})}function M(){const o=b({workflowOptions:[],workflow:m(null),seriesData:[],labelShow:m(!0),links:[]}),l=r=>{o.seriesData=[],o.links=[],o.seriesData=r.workFlowList.map(e=>({name:e.workFlowName,id:e.workFlowCode,...e})),o.links=r.workFlowRelationList.map(e=>({source:String(e.sourceWorkFlowCode),target:String(e.targetWorkFlowCode)}))};return{variables:o,getWorkflowName:r=>{const{state:e}=w($({projectCode:r}).then(n=>{o.workflowOptions=n.map(i=>({label:i.workFlowName,value:i.workFlowCode}))}),{});return e},getOneWorkflow:(r,e)=>{const{state:n}=w(E({workFlowCode:r},{projectCode:e}).then(i=>{l(i)}),{});return n},getWorkflowList:r=>{const{state:e}=w(q({projectCode:r}).then(n=>{l(n)}),{});return e}}}const No=k({name:"workflow-relation",setup(){const{t:o,locale:l}=_(),s=W(),{variables:a,getWorkflowName:c,getOneWorkflow:r,getWorkflowList:e}=M();N(()=>{e(Number(s.params.projectCode)),c(Number(s.params.projectCode))});const n=()=>{a.seriesData=[],a.workflow&&a.workflow!==0?r(Number(a.workflow),Number(s.params.projectCode)):e(Number(s.params.projectCode))};return j(()=>[a.workflow,a.labelShow,l.value],()=>{n()}),{t:o,handleResetDate:n,...y(a)}},render(){const{t:o,handleResetDate:l}=this;return this.seriesData.length===0&&t(D,{title:o("project.workflow.workflow_relation_no_data_result_title"),description:o("project.workflow.workflow_relation_no_data_result_desc"),status:"info",size:"medium"},null)||this.seriesData.length>0&&t(v,{title:o("project.workflow.workflow_relation")},{default:()=>Object.keys(this.seriesData).length>0&&t(F,{seriesData:this.seriesData,labelShow:this.labelShow,links:this.links},null),"header-extra":()=>t(S,null,{default:()=>[t(O,{clearable:!0,style:{width:"300px"},placeholder:o("project.workflow.workflow_name"),options:this.workflowOptions,value:this.workflow,"onUpdate:value":s=>this.workflow=s},null),t(p,{trigger:"hover"},{default:()=>o("project.workflow.refresh"),trigger:()=>t(f,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:l},{default:()=>[t(d,null,{default:()=>[t(R,null,null)]})]})}),t(p,{trigger:"hover"},{default:()=>o("project.workflow.show_hide_label"),trigger:()=>t(f,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:()=>this.labelShow=!this.labelShow},{default:()=>[t(d,null,{default:()=>[t(z,null,null)]})]})})]})})}});export{No as default};
